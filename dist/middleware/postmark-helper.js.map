{"version":3,"sources":["../../src/middleware/postmark-helper.js"],"names":["postmark_key","doc_id","pmClient","Client","sendNotification","req","res","next","emailList","receiversEmails","join","sendEmail","err","to","console","log","date","Date","toTimeString"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;IACOA,Y,kBAAAA,Y;IAAcC,M,kBAAAA,M;;AACrB,IAAMC,WAAW,IAAI,mBAASC,MAAb,CAAoBH,YAApB,CAAjB;;AAEA;AACA,SAASI,gBAAT,CAA0BC,GAA1B,EAA+BC,GAA/B,EAAoCC,IAApC,EAA0C;AAAA,MACjCC,SADiC,GACpBH,GADoB,CACjCG,SADiC;;;AAGxC,MAAIA,SAAJ,EAAe;AACb,QAAMC,kBAAkBD,UAAUE,IAAV,CAAe,IAAf,CAAxB;;AAEAR,aAASS,SAAT,CAAmB;AACjB,cAAQ,+BADS;AAEjB,YAAMF,eAFW;AAGjB,iBAAW,kBAHM;AAIjB,kBAAY,+DACV,2CADU,GACoCR;AAL/B,KAAnB,EAOA,UAACW,GAAD,EAAMC,EAAN,EAAa;AACX,UAAID,GAAJ,EAAS;AACPE,gBAAQC,GAAR,CAAYH,GAAZ;AACAL;AACD;;AAED,UAAMS,OAAO,IAAIC,IAAJ,EAAb;AACAH,cAAQC,GAAR,CAAYC,KAAKE,YAAL,EAAZ,EAAiC,kBAAjC;AACAJ,cAAQC,GAAR,CAAYF,EAAZ;AACAN;AACD,KAjBD;AAkBD,GArBD,MAqBO;AACL,QAAMS,OAAO,IAAIC,IAAJ,EAAb;AACAH,YAAQC,GAAR,CAAYC,KAAKE,YAAL,EAAZ,EAAiC,qBAAjC;AACAX;AACD;AACF;;kBAEcH,gB","file":"postmark-helper.js","sourcesContent":["import configAuth from '../config/auth.js';\nimport postmark from 'postmark';\nconst {postmark_key, doc_id} = configAuth;\nconst pmClient = new postmark.Client(postmark_key);\n\n// Send notification e-mail\nfunction sendNotification(req, res, next) {\n  const {emailList} = req;\n\n  if (emailList) {\n    const receiversEmails = emailList.join(', ');\n\n    pmClient.sendEmail({\n      'From': 'search.melbourne@mediacom.com',\n      'To': receiversEmails,\n      'Subject': 'Check URL Errors',\n      'TextBody': 'Check which URLs have changed, and which have errors here:' +\n        '\\nhttps://docs.google.com/spreadsheets/d/' + doc_id\n    },\n    (err, to) => {\n      if (err) {\n        console.log(err);\n        next();\n      }\n\n      const date = new Date();\n      console.log(date.toTimeString(), 'E-mail sent to: ');\n      console.log(to);\n      next();\n    });\n  } else {\n    const date = new Date();\n    console.log(date.toTimeString(), 'No e-mail addresses');\n    next();\n  }\n}\n\nexport default sendNotification;\n"]}